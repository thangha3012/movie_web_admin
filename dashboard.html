<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Quản Lý Web Xem Phim</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style-dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoJv0ua6eQb1U9PLaZtD2RhRxzQ1jv++a+AMVyTFeQvNFG/" crossorigin="anonymous" />

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <h4><i class="fas fa-film"></i> BestFilms</h4>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-item">
                <a href="#" class="nav-link active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#" class="nav-link" data-section="users">
                    <i class="fas fa-users"></i>
                    <span>Quản Lý Người Dùng</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#" class="nav-link" data-section="movies">
                    <i class="fas fa-video"></i>
                    <span>Quản Lý Phim</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#" class="nav-link" data-section="genres">
                    <i class="fas fa-list"></i>
                    <span>Quản Lý Danh Mục</span>
                </a>
            </div>
            <div class="nav-item">
                <a href="#" class="nav-link" data-section="categories">
                    <i class="fas fa-tags"></i>
                    <span>Quản Lý Thể Loại</span>
                </a>
            </div>
            <!-- <div class="nav-item">
                <a href="#" class="nav-link" data-section="countries">
                    <i class="fa-solid fa-truck-field-un"></i>
                    <span>Quản Lý Quốc Gia</span>
                </a>
            </div> -->
        </nav>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <div class="d-flex align-items-center">
                <button class="btn btn-link d-md-none" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h6 class="mb-0 ms-1">Chào mừng đến với Dashboard Quản Lý BestFilms</h6>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <h3 class="page-title">
                    <i class="fas fa-tachometer-alt"></i>
                    Dashboard Tổng Quan
                </h3>

                <div class="row">
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-number" id="//totalMovies">234</div>
                            <div>Tổng số phim</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-number" id="//totalUsers">3485</div>
                            <div>Người dùng</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-number" id="totalCategories">0</div>
                            <div>Thể loại</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-number" id="totalGenres">0</div>
                            <div>Danh mục</div>
                        </div>
                    </div>
                </div>

                <div class="container containerss">
                    <h3 class="page-title"><i class="fa-solid fa-chart-simple"></i>Biểu Đồ Thống Kê</h3>
                    <div class="charts-row">
                        <div class="cardss" style="flex:2">
                            <div class="chart-title">Lượt xem phim theo ngày</div>
                            <canvas id="viewsByDayChart" height="95"></canvas>
                        </div>
                        <div class="cardss">
                            <div class="chart-title">Phim phổ biến nhất</div>
                            <canvas id="popularmoviessChart" height="95"></canvas>
                        </div>
                    </div>
                    <div class="cardss" style="margin-top:24px;">
                        <div class="chart-title">Tương tác người dùng</div>
                        <ul id="userInteractions" class="mb-0"></ul>
                    </div>
                </div>

            </div>

            <!-- Categories Section -->
            <div id="categories" class="section">
                <h2 class="page-title">
                    <i class="fas fa-tags"></i>
                    Quản Lý Thể Loại
                </h2>

                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Danh Sách Thể Loại</h5>
                        <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#categoryModal"
                            onclick="openCategoryModal()">
                            <i class="fas fa-plus"></i> Thêm Thể Loại
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Tên Thể Loại</th>
                                        <th>Mô Tả</th>
                                        <th>Trạng Thái</th>
                                        <th>Hành Động</th>
                                    </tr>
                                </thead>
                                <tbody id="categoriesTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Users Section -->
            <div id="users" class="section">
                <h2 class="page-title">
                    <i class="fas fa-users"></i>
                    Quản Lý Người Dùng
                </h2>

                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Danh Sách Người Dùng</h5>
                        <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#userModal"
                            onclick="openUserModal()">
                            <i class="fas fa-plus"></i> Thêm Người Dùng
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Tên Đăng Nhập</th>
                                        <th>Email</th>
                                        <th>Họ Tên</th>
                                        <!-- <th>SDT</th>
                                        <th>Địa chỉ</th> -->
                                        <th>Vai Trò</th>
                                        <th>Trạng Thái</th>
                                        <th>Hành Động</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Movies Section -->
            <div id="movies" class="section">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="page-title">
                        <i class="fas fa-video"></i>
                        Quản Lý Phim
                    </h2>
                    <!-- //search -->
                    <div class="mb-3 f-left d-flex">
                        <input type="text" class="form-control" id="search-input" placeholder="Tìm kiếm phim...">
                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                    </div>
                </div>



                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Danh Sách Phim</h5>
                        <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#movieModal"
                            onclick="openMovieModal()">
                            <i class="fas fa-plus"></i> Thêm Phim
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Poster</th>
                                        <th>Tên Phim</th>
                                        <th>Thể Loại</th>
                                        <th>Năm</th>
                                        <th>Thời Lượng</th>
                                        <th>Quốc Gia</th>
                                        <th>Mô Tả</th>
                                        <th>Link Video</th>
                                        <th>Trạng Thái</th>
                                        <th>Hành Động</th>
                                    </tr>
                                </thead>
                                <tbody id="moviesTable">
                                </tbody>
                            </table>

                        </div>
                    </div>
                    <ul id="pagination" class="pagination justify-content-center mt-3"></ul>
                </div>
            </div>

            <!-- Genres Section -->
            <div id="genres" class="section">
                <h2 class="page-title">
                    <i class="fas fa-list"></i>
                    Quản Lý Danh Mục
                </h2>

                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Danh Sách Danh Mục</h5>
                        <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#genreModal"
                            onclick="openGenreModal()">
                            <i class="fas fa-plus"></i> Thêm Danh Mục
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Tên Danh Mục</th>
                                        <th>Mô Tả</th>
                                        <!-- <th>Số Phim</th> -->
                                        <th>Trạng Thái</th>
                                        <th>Hành Động</th>
                                    </tr>
                                </thead>
                                <tbody id="genresTable">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Category Modal -->
    <div class="modal fade" id="categoryModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="categoryModalTitle">Thêm Thể Loại</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="categoryForm">
                        <input type="hidden" id="categoryId">
                        <div class="mb-3">
                            <label for="categoryName" class="form-label">Tên Thể Loại</label>
                            <input type="text" class="form-control" id="categoryName" required>
                        </div>
                        <div class="mb-3">
                            <label for="categoryDescription" class="form-label">Mô Tả</label>
                            <textarea class="form-control" id="categoryDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="categoryStatus" class="form-label">Trạng Thái</label>
                            <select class="form-select" id="categoryStatus">
                                <option value="active">Hoạt động</option>
                                <option value="inactive">Không hoạt động</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-primary" onclick="saveCategory()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Modal -->
    <div class="modal fade" id="userModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalTitle">Thêm Người Dùng</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="userForm">
                        <input type="hidden" id="userId">
                        <div class="mb-3">
                            <label for="username" class="form-label">Tên Đăng Nhập</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="fullName" class="form-label">Họ Tên</label>
                            <input type="text" class="form-control" id="fullName" required>
                        </div>
                        <div class="mb-3">
                            <label for="userRole" class="form-label">Vai Trò</label>
                            <select class="form-select" id="userRole">
                                <option value="user">Người dùng</option>
                                <option value="admin">Quản trị viên</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="userStatus" class="form-label">Trạng Thái</label>
                            <select class="form-select" id="userStatus">
                                <option value="active">Hoạt động</option>
                                <option value="inactive">Không hoạt động</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-primary" onclick="saveUser()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Movie Modal -->
    <div class="modal fade" id="movieModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="movieModalTitle">Thêm Phim</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="movieForm">
                        <input type="hidden" id="movieId">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieTitle" class="form-label">Tên Phim</label>
                                    <input type="text" class="form-control" id="movieTitle" required>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieYear" class="form-label">Năm Sản Xuất</label>
                                    <input type="number" class="form-control" id="movieYear" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="moviePoster" class="form-label">Poster ảnh (URL)</label>
                                    <input type="text" class="form-control" id="moviePoster" placeholder="https://...">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieLinkVideo" class="form-label">Link Video (URL)</label>
                                    <input type="text" class="form-control" id="movieLinkVideo"
                                        placeholder="https://...">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieCategory" class="form-label">Thể Loại</label>
                                    <select class="form-select" id="movieCategory" required>
                                        <option value="">Chọn thể loại</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieDuration" class="form-label">Thời Lượng (phút)</label>
                                    <input type="number" class="form-control" id="movieDuration" required>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieCountry" class="form-label">Quốc Gia</label>
                                    <input type="text" class="form-control" id="movieCountry" min="1" max="10"
                                        step="0.1">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="movieStatus" class="form-label">Trạng Thái</label>
                                    <select class="form-select" id="movieStatus">
                                        <option value="active">Hoạt động</option>
                                        <option value="inactive">Không hoạt động</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="movieDescription" class="form-label">Mô Tả</label>
                            <textarea class="form-control" id="movieDescription" rows="4"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-primary" onclick="saveMovie()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Genre Modal -->
    <div class="modal fade" id="genreModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="genreModalTitle">Thêm Danh Mục</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="genreForm">
                        <input type="hidden" id="genreId">
                        <div class="mb-3">
                            <label for="genreName" class="form-label">Tên Danh Mục</label>
                            <input type="text" class="form-control" id="genreName" required>
                        </div>
                        <div class="mb-3">
                            <label for="genreDescription" class="form-label">Mô Tả</label>
                            <textarea class="form-control" id="genreDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="genreStatus" class="form-label">Trạng Thái</label>
                            <select class="form-select" id="genreStatus">
                                <option value="active">Hoạt động</option>
                                <option value="inactive">Không hoạt động</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                    <button type="button" class="btn btn-primary" onclick="saveGenre()">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <script>
        // Hàm rút gọn mô tả hiển thị ...
        function truncateDescription(description, maxLength = 27) {
            if (description.length > maxLength) {
                return description.substring(0, maxLength - 3) + '...';
            }
            return description;
        }

        // Data storage
        let categories = [
            { id: 1, name: 'Hành Động', description: 'Phim hành động kịch tính', status: 'active' },
            { id: 2, name: 'Tình Cảm', description: 'Phim tình cảm lãng mạn', status: 'active' },
            { id: 3, name: 'Kinh Dị', description: 'Phim kinh dị ma quái', status: 'active' },
            { id: 4, name: 'Cổ Trang', description: 'Phim lấy bối cảnh lịch sử, cổ đại hoặc huyền thoại', status: 'active' },
            { id: 5, name: 'Kinh Dị', description: 'Phim kinh dị ma quái, yếu tố rùng rợn', status: 'active' },
            { id: 6, name: 'Khoa Học', description: 'Phim có chủ đề khoa học, khám phá hoặc giả tưởng', status: 'active' },
            { id: 7, name: 'Tình Cảm', description: 'Phim về tình yêu, cảm xúc, lãng mạn', status: 'active' },
            { id: 8, name: 'Hài Hước', description: 'Phim hài giải trí, gây cười', status: 'active' },
            { id: 9, name: 'Hoạt Hình', description: 'Phim hoạt hình, vẽ tay hoặc đồ họa máy tính', status: 'active' },
            { id: 10, name: 'Gia Đình', description: 'Phim phù hợp với mọi lứa tuổi, chủ đề gia đình', status: 'active' },
            { id: 11, name: 'Chính Kịch', description: 'Phim kịch tính, tâm lý xã hội, cảm động', status: 'active' }

        ];

        let users = [
            { id: 1, username: 'nhattt', email: 'trinhthanhnhat12@gmail.com', fullName: 'Trịnh Thanh Nhất', role: 'admin', status: 'active' },
            { id: 2, username: 'duytv', email: 'trinhvanduy1212@gmail.com', fullName: 'Trịnh Văn Duy', role: 'admin', status: 'active' },
            { id: 3, username: 'thanghd', email: 'haducthang11@gmail.com', fullName: 'Hà Đức Thắng', role: 'admin', status: 'inactive' },
            { id: 4, username: 'hieunt', email: 'hieunt@gmail.com', fullName: 'Nguyễn Trung Hiếu', role: 'user', status: 'active' },
            { id: 5, username: 'thuylinh', email: 'thuylinh@gmail.com', fullName: 'Trần Thùy Linh', role: 'user', status: 'inactive' },
            { id: 6, username: 'minhphuc', email: 'minhphuc@gmail.com', fullName: 'Phạm Minh Phúc', role: 'user', status: 'active' },
            { id: 7, username: 'hoangyen', email: 'hoangyen@gmail.com', fullName: 'Lê Hoàng Yến', role: 'user', status: 'active' },
            { id: 8, username: 'vandan', email: 'vandan@gmail.com', fullName: 'Đặng Văn Dần', role: 'user', status: 'inactive' },
            { id: 9, username: 'thanhhuyen', email: 'thanhhuyen@gmail.com', fullName: 'Ngô Thanh Huyền', role: 'user', status: 'active' },
            { id: 10, username: 'quangvinh', email: 'quangvinh@gmail.com', fullName: 'Bùi Quang Vinh', role: 'user', status: 'active' },
            { id: 11, username: 'camtu', email: 'camtu@gmail.com', fullName: 'Vũ Cẩm Tú', role: 'user', status: 'inactive' },
            { id: 12, username: 'kienpham', email: 'kienpham@gmail.com', fullName: 'Phan Kiên', role: 'user', status: 'active' },
            { id: 13, username: 'thuha', email: 'thuha@gmail.com', fullName: 'Lý Thu Hà', role: 'user', status: 'active' }

        ];

        let movies = [
            { id: 1, poster: "assets/images/noibat/chiec-vong-ngoc-bich-17170-thumb.webp", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Avengers Endgame', category: 'Hành Động', year: 2019, duration: 181, country: 'Mỹ', status: 'active', description: 'Siêu anh hùng Marvel' },
            { id: 2, poster: "https://upload.wikimedia.org/wikipedia/vi/a/ab/Titanic_3D_poster_Vietnam.jpg", title: 'Titanic', linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", category: 'Tình Cảm', year: 1997, duration: 194, country: 'Anh', status: 'active', description: 'Câu chuyện tình yêu trên con tàu' },
            { id: 3, poster: "https://upload.wikimedia.org/wikipedia/vi/1/1f/Conjuring_poster.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'The Conjuring', category: 'Kinh Dị', year: 2013, duration: 112, country: 'Mỹ', status: 'active', description: 'Phim kinh dị về ma quái' },
            { id: 4, poster: "https://m.media-amazon.com/images/M/MV5BYjk1Y2U4MjQtY2ZiNS00OWQyLWI3MmYtZWUwNmRjYWRiNWNhXkEyXkFqcGc@._V1_.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Parasite', category: 'Kịch Tính', year: 2019, duration: 132, country: 'Hàn Quốc', status: 'active', description: 'Xung đột giàu nghèo trong xã hội Hàn Quốc' },
            { id: 5, poster: "https://m.media-amazon.com/images/M/MV5BNmEyZjI0M2MtNGFkOC00YTRlLWI0MGQtYTgyODY2MGRhMjc4XkEyXkFqcGc@._V1_.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Your Name', category: 'Hoạt Hình', year: 2016, duration: 106, country: 'Nhật Bản', status: 'active', description: 'Câu chuyện hoán đổi thân xác lãng mạn' },
            { id: 6, poster: "https://play-lh.googleusercontent.com/cp94GJsYWZCrf4bmYp3yZkuN7FAaorxZWh008_DUji0Qj2cfyILd7-h_611zbbiUEkg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Interstellar', category: 'Gia Đình', year: 2014, duration: 169, country: 'Mỹ', status: 'active', description: 'Hành trình khám phá không gian cứu loài người' },
            { id: 7, poster: "https://m.media-amazon.com/images/M/MV5BMTQ4MzQzMzM2Nl5BMl5BanBnXkFtZTgwMTQ1NzU3MDI@._V1_.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Dangal', category: 'Hài Hước', year: 2016, duration: 161, country: 'Trung Quốc', status: 'active', description: 'Hành trình vô địch của hai nữ đô vật Trung Quốc' },
            { id: 8, poster: "https://m.media-amazon.com/images/M/MV5BNTEyNmEwOWUtYzkyOC00ZTQ4LTllZmUtMjk0Y2YwOGUzYjRiXkEyXkFqcGc@._V1_.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Spirited Away', category: 'Hoạt Hình', year: 2001, duration: 125, country: 'Nhật Bản', status: 'active', description: 'Phiêu lưu trong thế giới linh hồn kỳ diệu' },
            { id: 9, poster: "https://upload.wikimedia.org/wikipedia/vi/8/81/ShawshankRedemptionMoviePoster.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'The Shawshank Redemption', category: 'Chính Kịch', year: 1994, duration: 142, country: 'Mỹ', status: 'active', description: 'Hành trình tìm lại tự do và hy vọng' },
            { id: 10, poster: "https://resizing.flixster.com/-XZAfHZM39UwaGJIFWKAE8fS0ak=/v3/t/assets/p9649633_p_v10_aa.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Inception', category: 'Khoa Học', year: 2010, duration: 148, country: 'Hàn Quốc', status: 'active', description: 'Xâm nhập vào giấc mơ để đánh cắp ý tưởng' },
            { id: 11, poster: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR8H1gjBYZylLkxx4bmtBBKhnIOhrLLkBbhgQ&s", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'Crouching Tiger, Hidden Dragon', category: 'Võ Thuật', year: 2000, duration: 120, country: 'Trung Quốc', status: 'active', description: 'Chuyện tình và kiếm thuật cổ trang Trung Hoa' },
            { id: 12, poster: "https://kienviet.net/wp-content/uploads/2022/12/MV5BM2MyNjYxNmUtYTAwNi00MTYxLWJmNWYtYzZlODY3ZTk3OTFlXkEyXkFqcGdeQXVyNzkwMjQ5NzM@._V1_.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'The Godfather', category: 'Hành Động', year: 1972, duration: 175, country: 'Mỹ', status: 'active', description: 'Cuộc sống gia đình mafia đầy quyền lực' },
            { id: 13, poster: "https://upload.wikimedia.org/wikipedia/en/9/9d/Disney_The_Lion_King_2019.jpg", linkVideo: "https://s6.kkphimplayer6.com/20250609/Z35RRqXq/3500kb/hls/index.m3u8", title: 'The Lion King', category: 'Hoạt Hình', year: 1994, duration: 88, country: 'Việt Nam', status: 'active', description: 'Hành trình trở về của vị vua sư tử trẻ tuổi' }

        ];

        let genres = [
            { id: 1, name: 'Trang chủ', description: 'Trang chủ trang website', status: 'active' },
            { id: 1, name: 'Phim Mới', description: 'Các bộ phim mới', status: 'active' },
            { id: 2, name: 'Thịnh Hành', description: 'Các bộ phim nhiều tập', status: 'active' },
            { id: 3, name: 'Quốc gia', description: 'Các quốc gia', status: 'active' },
            { id: 3, name: 'Nổi bật', description: 'Sidebar hiển thị các phim nổi bật', status: 'active' },
            { id: 3, name: 'Sắp chiếu', description: 'Sidebar hiển thị các phim sắp chiếu', status: 'active' },
            { id: 3, name: 'Top phim hay', description: 'Sidebar hiển thị các phim hay', status: 'active' },
            { id: 3, name: 'Lịch chiếu', description: 'Sidebar hiển thị các chiếu phim', status: 'active' },
        ];

        // Navigation
        $(document).ready(function () {
            loadDashboard();
            loadCategories();
            loadUsers();
            loadMovies();
            loadGenres();
            updateStats();

            // Sidebar navigation
            $('.nav-link').click(function (e) {
                e.preventDefault();
                $('.nav-link').removeClass('active');
                $(this).addClass('active');

                $('.section').removeClass('active');
                const section = $(this).data('section');
                $('#' + section).addClass('active');
            });

            // Mobile sidebar toggle
            $('#sidebarToggle').click(function () {
                $('.sidebar').toggleClass('show');
            });
        });

        // Dashboard functions
        function loadDashboard() {
            updateStats();
        }

        function updateStats() {
            $('#totalMovies').text(movies.length);
            $('#totalUsers').text(users.length);
            $('#totalCategories').text(categories.length);
            $('#totalGenres').text(genres.length);
        }

        // Category functions
        function loadCategories() {
            const tbody = $('#categoriesTable');
            tbody.empty();

            categories.forEach(category => {
                const statusBadge = category.status === 'active' ?
                    '<span class="badge bg-success">Hoạt động</span>' :
                    '<span class="badge bg-danger">Không hoạt động</span>';

                tbody.append(`
                    <tr>
                        <td>${category.id}</td>
                        <td>${category.name}</td>
                        <td>${category.description}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editCategory(${category.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger ms-1" onclick="deleteCategory(${category.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `);
            });
        }

        function openCategoryModal(id = null) {
            if (id) {
                const category = categories.find(c => c.id === id);
                $('#categoryModalTitle').text('Sửa Thể Loại');
                $('#categoryId').val(category.id);
                $('#categoryName').val(category.name);
                $('#categoryDescription').val(category.description);
                $('#categoryStatus').val(category.status);
            } else {
                $('#categoryModalTitle').text('Thêm Thể Loại');
                $('#categoryForm')[0].reset();
                $('#categoryId').val('');
            }
        }

        function editCategory(id) {
            openCategoryModal(id);
            $('#categoryModal').modal('show');
        }

        function saveCategory() {
            const id = $('#categoryId').val();
            const name = $('#categoryName').val();
            const description = $('#categoryDescription').val();
            const status = $('#categoryStatus').val();

            if (!name) {
                alert('Vui lòng nhập tên thể loại');
                return;
            }

            if (id) {
                // Update existing category
                const index = categories.findIndex(c => c.id == id);
                categories[index] = { id: parseInt(id), name, description, status };
            } else {
                // Add new category
                const newId = Math.max(...categories.map(c => c.id)) + 1;
                categories.push({ id: newId, name, description, status });
            }

            loadCategories();
            updateStats();
            $('#categoryModal').modal('hide');
        }

        function deleteCategory(id) {
            if (confirm('Bạn có chắc chắn muốn xóa thể loại này?')) {
                categories = categories.filter(c => c.id !== id);
                loadCategories();
                updateStats();
            }
        }

        // User functions
        function loadUsers() {
            const tbody = $('#usersTable');
            tbody.empty();

            users.forEach(user => {
                const statusBadge = user.status === 'active' ?
                    '<span class="badge bg-success">Hoạt động</span>' :
                    '<span class="badge bg-danger">Không hoạt động</span>';

                const roleBadge = user.role === 'admin' ?
                    '<span class="badge bg-warning">Admin</span>' :
                    '<span class="badge bg-info">User</span>';

                tbody.append(`
                    <tr>
                        <td>${user.id}</td>
                        <td>${user.username}</td>
                        <td>${user.email}</td>
                        <td>${user.fullName}</td>
                        <td>${roleBadge}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editUser(${user.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger ms-1" onclick="deleteUser(${user.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `);
            });
        }

        function openUserModal(id = null) {
            if (id) {
                const user = users.find(u => u.id === id);
                $('#userModalTitle').text('Sửa Người Dùng');
                $('#userId').val(user.id);
                $('#username').val(user.username);
                $('#email').val(user.email);
                $('#fullName').val(user.fullName);
                $('#userRole').val(user.role);
                $('#userStatus').val(user.status);
            } else {
                $('#userModalTitle').text('Thêm Người Dùng');
                $('#userForm')[0].reset();
                $('#userId').val('');
            }
        }

        function editUser(id) {
            openUserModal(id);
            $('#userModal').modal('show');
        }

        function saveUser() {
            const id = $('#userId').val();
            const username = $('#username').val();
            const email = $('#email').val();
            const fullName = $('#fullName').val();
            const role = $('#userRole').val();
            const status = $('#userStatus').val();

            if (!username || !email || !fullName) {
                alert('Vui lòng điền đầy đủ thông tin');
                return;
            }

            if (id) {
                // Update existing user
                const index = users.findIndex(u => u.id == id);
                users[index] = { id: parseInt(id), username, email, fullName, role, status };
            } else {
                // Add new user
                const newId = Math.max(...users.map(u => u.id)) + 1;
                users.push({ id: newId, username, email, fullName, role, status });
            }

            loadUsers();
            updateStats();
            $('#userModal').modal('hide');
        }

        function deleteUser(id) {
            if (confirm('Bạn có chắc chắn muốn xóa người dùng này?')) {
                users = users.filter(u => u.id !== id);
                loadUsers();
                updateStats();
            }
        }

        // Movie functions
        function loadMovies() {
            const tbody = $('#moviesTable');
            tbody.empty();

            // Update movie category dropdown
            const categorySelect = $('#movieCategory');
            categorySelect.empty();
            categorySelect.append('<option value="">Chọn thể loại</option>');
            categories.forEach(category => {
                categorySelect.append(`<option value="${category.name}">${category.name}</option>`);
            });

            movies.forEach(movie => {
                const statusBadge = movie.status === 'active' ?
                    '<span class="badge bg-success">Hoạt động</span>' :
                    '<span class="badge bg-danger">Không hoạt động</span>';



                tbody.append(`
                <tr>
                    <td>${movie.id}</td>
                    <td>
                        <img src="${movie.poster || 'https://via.placeholder.com/60x90?text=No+Poster'}"
                                alt="Poster"
                                style="width:60px;height:90px;object-fit:cover;border-radius:6px;">
                    </td>
                    <td>${movie.title}</td>
                    <td><span>${movie.category}</span></td>
                    <td>${movie.year}</td>
                    <td>${movie.duration} phút</td>
                    <td>${movie.country}</td>
                    <td>${truncateDescription(movie.description)}</td>
                    <td>${truncateDescription(movie.linkVideo)}</td>

                    <td>${statusBadge}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editMovie(${movie.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger ms-1" onclick="deleteMovie(${movie.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
                `);
            });
        }

        function openMovieModal(id = null) {
            if (id) {
                const movie = movies.find(m => m.id === id);
                $('#movieModalTitle').text('Sửa Phim');
                $('#movieId').val(movie.id);
                $('#movieTitle').val(movie.title);
                $('#movieCategory').val(movie.category);
                $('#movieYear').val(movie.year);
                $('#movieDuration').val(movie.duration);
                $('#movieCountry').val(movie.country);
                $('#movieStatus').val(movie.status);
                $('#movieDescription').val(movie.description);
                $('#movieLinkVideo').val(movie.linkVideo);
                $('#moviePoster').val(movie.poster);
            } else {
                $('#movieModalTitle').text('Thêm Phim');
                $('#movieForm')[0].reset();
                $('#movieId').val('');
                $('#moviePoster').val('');
            }
        }

        function editMovie(id) {
            openMovieModal(id);
            $('#movieModal').modal('show');
        }

        function saveMovie() {
            const id = $('#movieId').val();
            const title = $('#movieTitle').val();
            const category = $('#movieCategory').val();
            const year = $('#movieYear').val();
            const duration = $('#movieDuration').val();
            const country = $('#movieCountry').val();
            const status = $('#movieStatus').val();
            const description = $('#movieDescription').val();
            const linkVideo = $('#movieLinkVideo').val();
            const poster = $('#moviePoster').val();


            if (!title || !category || !year || !duration || !country || !poster || !linkVideo) {
                alert('Vui lòng điền đầy đủ thông tin bắt buộc');
                return;
            }

            if (id) {
                // Update existing movie
                const index = movies.findIndex(m => m.id == id);
                movies[index] = {
                    id: parseInt(id),
                    title,
                    category,
                    year: parseInt(year),
                    duration: parseInt(duration),
                    country,
                    status,
                    description,
                    poster,
                    linkVideo
                };
            } else {
                // Add new movie
                const newId = Math.max(...movies.map(m => m.id)) + 1;
                movies.push({
                    id: newId,
                    title,
                    category,
                    year: parseInt(year),
                    duration: parseInt(duration),
                    country,
                    status,
                    description,
                    poster,
                    linkVideo
                });
            }

            loadMovies();
            updateStats();
            $('#movieModal').modal('hide');
        }

        function deleteMovie(id) {
            if (confirm('Bạn có chắc chắn muốn xóa phim này?')) {
                movies = movies.filter(m => m.id !== id);
                loadMovies();
                updateStats();
            }
        }

        // Genre functions
        function loadGenres() {
            const tbody = $('#genresTable');
            tbody.empty();

            genres.forEach(genre => {
                const statusBadge = genre.status === 'active' ?
                    '<span class="badge bg-success">Hoạt động</span>' :
                    '<span class="badge bg-danger">Không hoạt động</span>';

                tbody.append(`
                    <tr>
                        <td>${genre.id}</td>
                        <td>${genre.name}</td>
                        <td>${genre.description}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editGenre(${genre.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger ms-1" onclick="deleteGenre(${genre.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `);
            });
        }

        function openGenreModal(id = null) {
            if (id) {
                const genre = genres.find(g => g.id === id);
                $('#genreModalTitle').text('Sửa Danh Mục');
                $('#genreId').val(genre.id);
                $('#genreName').val(genre.name);
                $('#genreDescription').val(genre.description);
                $('#genreStatus').val(genre.status);
            } else {
                $('#genreModalTitle').text('Thêm Danh Mục');
                $('#genreForm')[0].reset();
                $('#genreId').val('');
            }
        }

        function editGenre(id) {
            openGenreModal(id);
            $('#genreModal').modal('show');
        }

        function saveGenre() {
            const id = $('#genreId').val();
            const name = $('#genreName').val();
            const description = $('#genreDescription').val();
            const status = $('#genreStatus').val();

            if (!name) {
                alert('Vui lòng nhập tên danh mục');
                return;
            }

            if (id) {
                // Update existing genre
                const index = genres.findIndex(g => g.id == id);
                genres[index] = {
                    ...genres[index],
                    id: parseInt(id),
                    name,
                    description,
                    status
                };
            } else {
                // Add new genre
                const newId = Math.max(...genres.map(g => g.id)) + 1;
                genres.push({
                    id: newId,
                    name,
                    description,
                    status
                });
            }

            loadGenres();
            updateStats();
            $('#genreModal').modal('hide');
        }

        function deleteGenre(id) {
            if (confirm('Bạn có chắc chắn muốn xóa danh mục này?')) {
                genres = genres.filter(g => g.id !== id);
                loadGenres();
                updateStats();
            }
        }
    </script>

    <script>
        const itemsPerPage = 5;
        let paginatedRows = [];

        function filterTableRows($rows, keyword) {
            keyword = keyword.toLowerCase().trim();
            return $rows.filter(function () {
                return $(this).text().toLowerCase().includes(keyword);
            });
        }

        function showTablePage($rows, page) {
            $rows.hide();
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            $rows.slice(start, end).show();
        }

        function paginateTable($filteredRows) {
            paginatedRows = $filteredRows.toArray();
            const totalPages = Math.ceil(paginatedRows.length / itemsPerPage);
            $('#pagination').empty();

            $('#moviesTable tr').hide(); // Ẩn tất cả trước

            if (totalPages <= 1) {
                showTablePage($filteredRows, 1);
                return;
            }

            for (let i = 1; i <= totalPages; i++) {
                $('#pagination').append(`<li class="page-item"><a class="page-link" href="#" data-page="${i}">${i}</a></li>`);
            }

            showTablePage($filteredRows, 1);
            $('#pagination li:first').addClass('active');
        }


        $('#search-input').on('input', function () {
            const keyword = $(this).val();
            const $rows = $('#moviesTable tr');

            const filtered = filterTableRows($rows, keyword);
            paginateTable($(filtered));
        });

        $('#pagination').on('click', '.page-link', function (e) {
            e.preventDefault();
            const page = $(this).data('page');
            showTablePage($(paginatedRows), page);
            $('#pagination .page-item').removeClass('active');
            $(this).parent().addClass('active');
        });

        $(document).ready(function () {
            paginateTable($('#moviesTable tr'));
        });
    </script>

    <script>
        // Biểu đồ lượt xem phim theo ngày (line area)
        const viewsDayCtx = document.getElementById("viewsByDayChart").getContext("2d");
        new Chart(viewsDayCtx, {
            type: "line",
            data: {
                labels: ["01-06", "02-06", "03-06", "04-06", "05-06", "06-06", "07-06"],
                datasets: [{
                    data: [150, 205, 180, 220, 240, 295, 310],
                    backgroundColor: "rgba(13, 110, 253, 0.14)",
                    borderColor: "#298aff",
                    borderWidth: 3,
                    fill: true,
                    tension: 0.34,
                    pointRadius: 5,
                    pointBackgroundColor: "#298aff",
                }],
            },
            options: {
                plugins: {
                    legend: { display: false },
                },
                scales: {
                    x: { grid: { display: true, color: "#eee" } },
                    y: {
                        min: 0, max: 350,
                        grid: { color: "#eee" },
                        ticks: { stepSize: 50 }
                    }
                }
            }
        });

        // Biểu đồ phim phổ biến nhất (bar)
        const moviess = [
            { name: "Chiến binh dũng cảm", views: 5600 },
            { name: "Bí ẩn vùng đất", views: 3200 },
            { name: "Tình yêu và định mệnh", views: 4000 },
            { name: "Mật danh Sấm Chớp", views: 2700 },
            { name: "Hành trình số phận", views: 2200 }
        ];
        const ctxmoviess = document.getElementById("popularmoviessChart").getContext("2d");
        new Chart(ctxmoviess, {
            type: "bar",
            data: {
                labels: moviess.map(m => m.name),
                datasets: [{
                    data: moviess.map(m => m.views),
                    backgroundColor: [
                        "rgba(52, 126, 255, 0.90)",
                        "rgba(52, 126, 255, 0.68)",
                        "rgba(52, 126, 255, 0.48)",
                        "rgba(52, 126, 255, 0.32)",
                        "rgba(52, 126, 255, 0.17)"
                    ],
                    borderRadius: 8,
                    borderSkipped: false
                }]
            },
            options: {
                plugins: { legend: { display: false } },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { stepSize: 1000 },
                        grid: { color: "#eee" }
                    },
                    x: {
                        grid: { color: "#fff" }
                    }
                }
            }
        });

        // Tương tác người dùng (demo list)
        const interactions = [
            "Người dùng Nguyễn Văn A đã xem 5 phim hôm nay.",
            "Bình luận mới trên phim 'Chiến binh dũng cảm'.",
            "Đánh giá 5 sao cho phim 'Tình yêu và định mệnh'."
        ];
        const list = document.getElementById("userInteractions");
        interactions.forEach(i => {
            const li = document.createElement("li");
            li.textContent = i;
            list.appendChild(li);
        });
    </script>
</body>

</html>